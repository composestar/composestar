<?xml version='1.0' encoding='utf-8'?> 
<secret>
	
	<filters>
		<filter type="Error">
			<accept action="continue"/>
			<reject action="error"/>
		</filter>
		<filter type="Dispatch">
			<accept action="dispatch"/>
			<reject action="continue"/>
		</filter>
		<filter type="Meta">
			<accept action="meta"/>
			<reject action="continue"/>
		</filter>
		<filter type="Substitute">
			<accept action="substitute"/>
			<reject action="continue"/>
		</filter>
		<filter type="Wait">
			<accept action="continue"/>
			<reject action="wait"/>
		</filter>
	</filters>
	
	<actions>
		<action name="continue"/>		
		<action name="meta"/>
		
		<action name="error" endofset="true">
			<operation name="c" resource="args"/>
			<operation name="e" resource="message"/>
			<operation name="return" resource="message"/>
		</action>
		
		<action name="dispatch" endofset="true">
			<operation name="d" resource="message"/>
			<operation name="w" resource="target"/>
			<operation name="w" resource="selector"/>
			<operation name="r" resource="args"/>
			<operation name="return" resource="message"/> 
		</action>
			
		<action name="substitute">
			<operation name="w" resource="target"/>
			<operation name="w" resource="selector"/>
		</action>
		
		<action name="wait">
			<operation name="w" resource="timing"/>
		</action>
		
	</actions>
	
	<constraints>
		<conflict pattern="((r)(R))+.*e" resource="message" message="Message is returned before it could error.."/>
		<conflict pattern="l((r)(w))+" resource="args" message="Locked resources can not be written."/>
		<conflict pattern="((r)(w))+.*c" resource="*" message="Discarded resource has been used"/>
		<conflict pattern="(r)(d)" resource="args" message="Arguments should be decrypted before logging!" />
		<conflict pattern="(E)(r)" resource="args" message="Arguments should be encrypted after logging!" />
	</constraints>

</secret>
