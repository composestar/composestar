<project name="ComposestarAnt" default="install">

	<description>Builds the Java tasks used by AntSystemTest.</description>

	<condition property="build.core" value="${basedir}/../../../../Core">
		<and>
			<not><isset property="build.core"/></not>
			<available file="${basedir}/../../../../Core/common.xml"/>
		</and>
	</condition>
	
	<import file="${build.core}/common.xml"/>
	
	<target name="init_local" depends="init">
		<property name="ant.base"    location="${build.core}/Development/Ant"/>
		<property name="ant.lib"     location="${ant.base}/lib"/>
		<property name="tasks.base"  location="${basedir}"/>
		<property name="tasks.src"   location="${tasks.base}/src"/>
		<property name="tasks.build" location="${tasks.base}/build"/>
		<property name="tasks.dist"  location="${tasks.base}/dist"/>
		
		<property name="ant.jar"     location="${ant.lib}/ant.jar"/>
		<property name="tasks.jar"   location="${tasks.dist}/ComposestarAnt.jar"/>
		<property name="jtasks.jar"   location="${tasks.dist}/ComposestarAntJava.jar"/>
		
		<mkdir dir="${tasks.build}"/>
		<mkdir dir="${tasks.dist}"/>
	</target>
	
	<target name="clean" depends="init_local">
		<delete dir="${tasks.build}"/>
		<delete dir="${tasks.dist}"/>
	</target>

	<target name="build" depends="init_local, compile, jar">
	</target>
	
	<target name="compile" depends="init_local">
		<javac srcdir="${tasks.src}" destdir="${tasks.build}" source="${build.java.version}" target="${build.java.version}" debug="${build.debug}" deprecation="${build.deprecation}">
			<classpath>
				<pathelement location="${ant.jar}"/>
				<pathelement location="${tasks.jar}"/>
			</classpath>
		</javac>
	</target>
	
	<target name="jar" depends="compile">
		<jar destfile="${jtasks.jar}" basedir="${tasks.build}"/> 
	</target>
	
	<target name="install" depends="init_local,build">
		<copy todir="${ant.lib}" file="${jtasks.jar}"/>
	</target>
	
</project>